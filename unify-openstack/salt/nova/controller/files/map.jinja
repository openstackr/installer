
{% set nova_controller =  salt['grains.filter_by']({
    'RedHat': {
        'name': 'nova',
        'password': 'password',
        'vnc_port': '6080',
        'email': 'nova@test.com',
        
    },
    'Debian': {
       'name': 'nova',
        'password': 'password',
        'vnc_port': '6080',
        'email': 'nova@test.com',

    },
}, merge=salt['pillar.get']('openstack-instance:' + pillar['current-openstack-instance'] + ':openstack-components:nova:controller')) %}


{% set nova_controller_service =  salt['grains.filter_by']({
    'RedHat': {
        'nova_api': 'openstack-nova-api',
        'nova_cert': 'openstack-nova-cert',
        'nova_auth': 'openstack-nova-consoleauth',
        'nova_scheduler': 'openstack-nova-scheduler',
        'nova_conductor': 'openstack-nova-conductor',
        'nova_novncproxy': 'openstack-nova-novncproxy',
    },
    'Debian': {
        'nova_api': 'openstack-nova-api',
        'nova_cert': 'openstack-nova-cert',
        'nova_auth': 'openstack-nova-consoleauth',
        'nova_scheduler': 'openstack-nova-scheduler',
        'nova_conductor': 'openstack-nova-conductor',
        'nova_novncproxy': 'openstack-nova-novncproxy',

    },
}, ) %}



{% set controller_ip = [] %}
  {%- for key, value in salt['mine.get']('G@openstack-id:' + grains['openstack-id'] + ' and G@function:controller','network.ip_addrs','compound').items() -%}
    {% do controller_ip.append(value) %}
  {%- endfor -%}


