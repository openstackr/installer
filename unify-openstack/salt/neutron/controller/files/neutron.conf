{% from "neutron/controller/files/map.jinja" import neutron_controller,controller_ip with context %}
{% from "rabbitmq/files/map.jinja" import rabbitmq with context %}
{% from "nova/controller/files/map.jinja" import nova_controller  with context %}
{% from "rabbitmq/files/map.jinja" import rabbitmq with context %}
{% from "mysql_server/files/map.jinja" import mysql with context %}

[database]
connection = mysql://{{ neutron_controller.name }}:{{ neutron_controller.password }}@{{ mysql.conn_host }}/{{ neutron_controller.name }}

[DEFAULT]
rabbit_host= {{ rabbitmq.rabbitmq_host }}
rabbit_password= {{ rabbitmq.rabbitmq_password }}
rpc_backend= {{ rabbitmq.rpc_backend }}
auth_strategy = keystone
 
[keystone_authtoken]
auth_uri = http://{{ controller_ip[0]|join(' ') }}:5000/v2.0
identity_uri = http://{{ controller_ip[0]|join(' ') }}:35357
admin_tenant_name = service
admin_user = {{ neutron_controller.name }} 
admin_password = {{ neutron_controller.password }} 


core_plugin = ml2
service_plugins = router
allow_overlapping_ips = True


notify_nova_on_port_status_changes = True
notify_nova_on_port_data_changes = True
nova_url = http://{{ controller_ip[0]|join(' ') }}:8774/v2
nova_admin_auth_url = http://{{ controller_ip[0]|join(' ') }}:35357/v2.0
nova_region_name = regionOne
nova_admin_username = {{ nova_controller.name }}
nova_admin_tenant_id = SERVICE_TENANT_ID
nova_admin_password = {{ nova_controller.password }} 

